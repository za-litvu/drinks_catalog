{# templates/catalog/index.html #}
<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Каталог напитков</title>

  <style>
    :root{
      --bg:#f6f7f9;
      --card:#ffffff;
      --muted:#6b6f76;
      --accent:#2b6cb0;
      --gap:18px;
    }

    html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Helvetica Neue",Arial;}
    body{background:var(--bg);color:#111;padding:0 20px;box-sizing:border-box;display:flex;flex-direction:column;min-height:100vh;}

    /* Header */
    header.site-header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding:20px 0;
    }
    .brand{
      display:flex;
      align-items:center;
      gap:12px;
      text-decoration:none;color:inherit;
    }
    .brand h1{font-size:20px;margin:0;letter-spacing:0.2px;}
    .search {
      margin-left:auto;
    }
    .search input{
      padding:8px 10px;border-radius:8px;border:1px solid #e2e8f0;background:white;
      min-width:220px;
    }

    /* Grid */
    main{flex:1 0 auto;}
    .grid{
      display:grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap:var(--gap);
      align-items:start;
      padding-bottom:40px;
    }

    .card{
      background:var(--card);
      border-radius:10px;
      box-shadow:0 1px 0 rgba(16,24,40,0.03), 0 6px 18px rgba(17,24,39,0.06);
      overflow:hidden;
      display:flex;
      flex-direction:column;
      min-height:220px;
      transition:transform .12s ease, box-shadow .12s ease;
    }
    .card:hover{ transform:translateY(-6px); box-shadow:0 8px 30px rgba(17,24,39,0.08); }

    .card .media{
      height:140px;
      background:#f0f2f5;
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
    }
    .card .media img{ width:100%; height:100%; object-fit:cover; display:block; }

    .card .body{
      padding:12px 14px; display:flex; flex-direction:column; gap:8px; flex:1;
    }
    .card .title{ font-weight:600; font-size:15px; margin:0; display:flex; justify-content:space-between; gap:8px; }
    .card .meta{ font-size:13px; color:var(--muted); display:flex; gap:8px; align-items:center; }
    .card .desc{ font-size:13px; color:#2b2b2b; line-height:1.3; overflow:hidden; display:-webkit-box; -webkit-line-clamp:3; -webkit-box-orient:vertical; }

    .card .actions{ margin-top:auto; display:flex; justify-content:space-between; align-items:center; gap:8px; }
    .btn{
      border:0;padding:8px 10px;border-radius:8px;background:var(--accent);color:white;font-size:13px;text-decoration:none;
    }

    footer{ padding:18px 0; color:var(--muted); font-size:13px; text-align:center; }
    @media (max-width:420px){
      .search input{ min-width:120px; }
      .brand h1{ font-size:16px; }
    }
  </style>
</head>
<body>
  <header class="site-header">
    <a href="{% url 'catalog:index' %}" class="brand">
      <svg width="36" height="36" viewBox="0 0 24 24" fill="none" aria-hidden>
        <rect width="24" height="24" rx="6" fill="#2b6cb0"/>
        <path d="M6 14c1-3 6-3 8-1s2 4 0 6" stroke="#fff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <h1>Каталог напитков</h1>
    </a>

    <form method="get" action="{% url 'catalog:index' %}" class="search" role="search">
      <input name="q" value="{{ request.GET.q }}" placeholder="Поиск: название, бренд, тег…" aria-label="Поиск напитков" />
    </form>
  </header>

  <main>
    <div class="grid">
      {% for drink in drinks %}
        <article class="card" aria-labelledby="drink-{{ drink.id }}">
          <div class="media">
            {% if drink.image %}
              <img src="{{ drink.image.url }}" alt="{{ drink.name }}">
            {% else %}
              <svg width="100%" height="100%" viewBox="0 0 200 140" preserveAspectRatio="xMidYMid slice" aria-hidden>
                <rect width="200" height="140" fill="#f0f2f5"></rect>
                <g fill="#d0d6dd">
                  <rect x="30" y="30" width="140" height="80" rx="6"></rect>
                </g>
              </svg>
            {% endif %}
          </div>

          <div class="body">
            <h2 id="drink-{{ drink.id }}" class="title">
              <span>{{ drink.name }}</span>
              {% if drink.brand %}<small class="meta">{{ drink.brand }}</small>{% endif %}
            </h2>

            <div class="meta">
              <span>{% if drink.type %}{{ drink.type.name }}{% else %}—{% endif %}</span>
              <span>•</span>
              <span>
                Рейтинг:
                {% if drink.avg_rating %}
                  {{ drink.avg_rating|floatformat:1 }}/5
                {% else %}
                  —
                {% endif %}
              </span>
            </div>

            {% if drink.description %}
              <p class="desc">{{ drink.description }}</p>
            {% else %}
              <p class="desc" style="color:var(--muted)">Описание отсутствует.</p>
            {% endif %}

            <div class="actions">
              <a class="btn" href="{% url 'catalog:detail' drink.pk %}">Открыть</a>
              <div style="font-size:13px;color:var(--muted)">{% if drink.reviews.count %}{{ drink.reviews.count }} отзыв(ов){% else %}Нет отзывов{% endif %}</div>
            </div>
          </div>
        </article>
      {% empty %}
        <div style="grid-column:1/-1;padding:40px;text-align:center;color:var(--muted)">
          Пока нет напитков. Добавь первый.
        </div>
      {% endfor %}
    </div>
  </main>

  <footer>
    © {{ now.year }} — простой каталог напитков
  </footer>
</body>
</html>
